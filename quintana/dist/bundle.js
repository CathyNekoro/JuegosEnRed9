(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=Phaser;var s=e.n(t);class i extends s().Scene{constructor(){super("MenuScene")}create(){this.add.text(400,100,"PONG GAME",{fontSize:"64px",color:"#ffffffff"}).setOrigin(.5);const e=this.add.text(400,300,"Local Play",{fontSize:"24px",color:"#1dd627ff"}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointover",()=>e.setStyle({fill:"#e7b14dff"})).on("pointout",()=>e.setStyle({fill:"#1dd627ff"})).on("pointerdown",()=>{this.scene.start("GameScene")})}}class a{constructor(e,t,s,i){this.id=t,this.scene=e,this.score=0,this.baseHeight=100,this.baseWidth=20,this.baseSpeed=300;const a=this.scene.add.graphics();a.fillStyle(65280),a.fillRect(0,0,this.baseWidth,this.baseHeight),a.generateTexture(`paddle-${t}`,this.baseWidth,this.baseHeight),a.destroy(),this.sprite=this.scene.physics.add.sprite(s,i,`paddle-${t}`),this.sprite.setImmovable(!0),this.sprite.setCollideWorldBounds(!0),this.sprite.body.allowGravity=!1}}class o extends s().Scene{constructor(){super("GameScene")}init(){this.players=new Map,this.inputsMapping=[],this.ball=null,this.isPaused=!1,this.escWasDown=!1,this.playing=!1}create(){for(let e=0;e<17;e++)this.add.rectangle(400,50*e+25,10,30,16777215);this.scoreLeft=this.add.text(100,50,"0",{fontSize:"48px",color:"#00ff00"}),this.scoreRight=this.add.text(700,50,"0",{fontSize:"48px",color:"#00ff00"}),this.createBounds(),this.createBall(),this.launchBall(),this.setUpPLayers(),this.players.forEach(e=>{this.physics.add.collider(this.ball,e.sprite)}),this.physics.add.overlap(this.ball,this.leftGoal,this.scoreRightGoal,null,this),this.physics.add.overlap(this.ball,this.rightGoal,this.scoreLeftGoal,null,this),this.escKey=this.input.keyboard.addKey(s().Input.Keyboard.KeyCodes.ESC)}setUpPLayers(){const e=new a(this,"player1",50,300),t=new a(this,"player2",750,300);this.players.set("player1",e),this.players.set("player2",t),this.inputsMapping=[{playerId:"player1",upKey:"W",downKey:"S"},{playerId:"player2",upKey:"UP",downKey:"DOWN"}],this.inputsMapping=this.inputsMapping.map(e=>({playerId:e.playerId,upKeyObj:this.input.keyboard.addKey(s().Input.Keyboard.KeyCodes[e.upKey]),downKeyObj:this.input.keyboard.addKey(s().Input.Keyboard.KeyCodes[e.downKey])}))}scoreRightGoal(){if(!this.playing)return;this.playing=!1;const e=this.players.get("player2");e.score+=1,this.scoreRight.setText(e.score.toString()),e.score>=2?this.endGame("player2"):this.resetBall()}scoreLeftGoal(){if(!this.playing)return;this.playing=!1;const e=this.players.get("player1");e.score+=1,this.scoreLeft.setText(e.score.toString()),e.score>=2?this.endGame("player1"):this.resetBall()}endGame(e){this.ball.setVelocity(0,0),this.players.forEach(e=>{e.sprite.setVelocity(0,0)}),this.physics.pause();const t="player1"===e?"Left Player Wins!":"Right Player Wins!";this.add.text(400,250,t,{fontSize:"64px",color:"#00ff00"}).setOrigin(.5);const s=this.add.text(400,350,"Return to Menu",{fontSize:"32px",color:"#ffffff"}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointerover",()=>s.setColor("#cccccc")).on("pointerout",()=>s.setColor("#ffffff")).on("pointerdown",()=>{this.scene.start("MenuScene")})}resetBall(){this.ball.setVelocity(0,0),this.ball.setPosition(400,300),this.time.delayedCall(1e3,()=>{this.launchBall()})}createBounds(){this.leftGoal=this.physics.add.sprite(0,300,null),this.leftGoal.setDisplaySize(10,600),this.leftGoal.body.setSize(10,600),this.leftGoal.setImmovable(!1),this.leftGoal.setVisible(!1),this.rightGoal=this.physics.add.sprite(800,300,null),this.rightGoal.setDisplaySize(10,600),this.rightGoal.body.setSize(10,600),this.rightGoal.setImmovable(!1),this.rightGoal.setVisible(!1)}createBall(){const e=this.add.graphics();e.fillStyle(16777215),e.fillCircle(8,8,8),e.generateTexture("ball",16,16),e.destroy(),this.ball=this.physics.add.image(400,300,"ball"),this.ball.setCollideWorldBounds(!0),this.ball.setBounce(1)}launchBall(){const e=s().Math.Between(-30,30),t=Math.random()<.5?1:-1;this.playing=!0,this.ball.setVelocity(400*Math.cos(s().Math.DegToRad(e))*t,400*Math.sin(s().Math.DegToRad(e)))}setPauseState(e){this.isPaused=e,this.isPaused&&(this.scene.launch("PauseScene",{originalScene:"GameScene"}),this.scene.pause())}resume(){this.isPaused=!1}togglePause(){const e=!this.isPaused;this.setPauseState(e)}update(){this.escKey.isDown&&this.togglePause(),this.inputsMapping.forEach(e=>{const t=this.players.get(e.playerId);e.upKeyObj.isDown?t.sprite.setVelocityY(-t.baseSpeed):e.downKeyObj.isDown?t.sprite.setVelocityY(+t.baseSpeed):t.sprite.setVelocityY(0)})}}class l extends s().Scene{constructor(){super("PauseScene")}create(e){this.add.rectangle(400,300,0,0,0,.1);const t=this.add.text(400,320,"Resume",{fontSize:"32px",color:"#00ff00"}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointover",()=>t.setStyle({fill:"#00ff88"})).on("pointout",()=>t.setStyle({fill:"#00ff00"})).on("pointerdown",()=>{this.scene.stop(),this.scene.resume(e.originalScene),this.scene.get(e.originalScene).resume()}),s=this.add.text(400,400,"Return to Menu",{fontSize:"32px",color:"#ffffff"}).setOrigin(.5).setInteractive({useHandCursor:!0}).on("pointover",()=>s.setStyle({fill:"#ff8888"})).on("pointout",()=>s.setStyle({fill:"#ffffff"})).on("pointerdown",()=>{this.scene.stop(e.originalScene),this.scene.start("MenuScene")})}}const n={type:s().AUTO,width:800,height:600,parent:"game-container",physics:{default:"arcade",arcade:{gravity:{y:0},debug:!1}},scene:[i,o,l],backgroundColor:"#360246ff"};new(s().Game)(n)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwibWFwcGluZ3MiOiJtQkFDQSxJQUFJQSxFQUFzQixDQ0ExQkEsRUFBeUJDLElBQ3hCLElBQUlDLEVBQVNELEdBQVVBLEVBQU9FLFdBQzdCLElBQU9GLEVBQWlCLFFBQ3hCLElBQU0sRUFFUCxPQURBRCxFQUFvQkksRUFBRUYsRUFBUSxDQUFFRyxFQUFHSCxJQUM1QkEsR0NMUkYsRUFBd0IsQ0FBQ00sRUFBU0MsS0FDakMsSUFBSSxJQUFJQyxLQUFPRCxFQUNYUCxFQUFvQlMsRUFBRUYsRUFBWUMsS0FBU1IsRUFBb0JTLEVBQUVILEVBQVNFLElBQzVFRSxPQUFPQyxlQUFlTCxFQUFTRSxFQUFLLENBQUVJLFlBQVksRUFBTUMsSUFBS04sRUFBV0MsTUNKM0VSLEVBQXdCLENBQUNjLEVBQUtDLElBQVVMLE9BQU9NLFVBQVVDLGVBQWVDLEtBQUtKLEVBQUtDLElDQWxGLE1BQU0sRUFBK0JJLE8sYUNFOUIsTUFBTUMsVUFBa0IsVUFDM0IsV0FBQUMsR0FDSUMsTUFBTSxZQUNWLENBRUEsTUFBQUMsR0FDSUMsS0FBS0MsSUFBSUMsS0FBSyxJQUFJLElBQUssWUFDdkIsQ0FBSUMsU0FBVSxPQUNWQyxNQUFPLGNBQ1JDLFVBQVUsSUFFYixNQUFNQyxFQUFXTixLQUFLQyxJQUFJQyxLQUFLLElBQUssSUFBSyxhQUFjLENBQ25EQyxTQUFVLE9BQVFDLE1BQU8sY0FDMUJDLFVBQVUsSUFDWkUsZUFBZSxDQUFDQyxlQUFlLElBQy9CQyxHQUFHLFlBQWEsSUFBTUgsRUFBU0ksU0FBUyxDQUFDQyxLQUFNLGVBQy9DRixHQUFHLFdBQVksSUFBTUgsRUFBU0ksU0FBUyxDQUFDQyxLQUFNLGVBQzlDRixHQUFHLGNBQWUsS0FDZlQsS0FBS1ksTUFBTUMsTUFBTSxjQUd6QixFQ3ZCRyxNQUFNQyxFQUVULFdBQUFqQixDQUFZZSxFQUFPRyxFQUFJQyxFQUFHQyxHQUN0QmpCLEtBQUtlLEdBQUtBLEVBQ1ZmLEtBQUtZLE1BQVFBLEVBQ2JaLEtBQUtrQixNQUFRLEVBRWJsQixLQUFLbUIsV0FBYSxJQUNsQm5CLEtBQUtvQixVQUFZLEdBQ2pCcEIsS0FBS3FCLFVBQVksSUFFakIsTUFBTUMsRUFBV3RCLEtBQUtZLE1BQU1YLElBQUlxQixXQUNoQ0EsRUFBU0MsVUFBVSxPQUNuQkQsRUFBU0UsU0FBUyxFQUFHLEVBQUd4QixLQUFLb0IsVUFBV3BCLEtBQUttQixZQUM3Q0csRUFBU0csZ0JBQWdCLFVBQVVWLElBQU1mLEtBQUtvQixVQUFXcEIsS0FBS21CLFlBQzlERyxFQUFTSSxVQUVUMUIsS0FBSzJCLE9BQVMzQixLQUFLWSxNQUFNZ0IsUUFBUTNCLElBQUkwQixPQUFPWCxFQUFHQyxFQUFHLFVBQVVGLEtBQzVEZixLQUFLMkIsT0FBT0UsY0FBYSxHQUN6QjdCLEtBQUsyQixPQUFPRyx1QkFBc0IsR0FDbEM5QixLQUFLMkIsT0FBT0ksS0FBS0MsY0FBZSxDQUNwQyxFQ2xCRyxNQUFNQyxVQUFrQixVQUMzQixXQUFBcEMsR0FDSUMsTUFBTSxZQUNWLENBRUEsSUFBQW9DLEdBQ0lsQyxLQUFLbUMsUUFBVSxJQUFJQyxJQUNuQnBDLEtBQUtxQyxjQUFnQixHQUNyQnJDLEtBQUtzQyxLQUFPLEtBQ1p0QyxLQUFLdUMsVUFBVyxFQUNoQnZDLEtBQUt3QyxZQUFhLEVBQ2xCeEMsS0FBS3lDLFNBQVUsQ0FDbkIsQ0FFQSxNQUFBMUMsR0FDSSxJQUFLLElBQUkyQyxFQUFJLEVBQUdBLEVBQUksR0FBR0EsSUFDbkIxQyxLQUFLQyxJQUFJMEMsVUFBVSxJQUFTLEdBQUpELEVBQVMsR0FBSSxHQUFJLEdBQUksVUFJakQxQyxLQUFLNEMsVUFBWTVDLEtBQUtDLElBQUlDLEtBQUssSUFBSyxHQUFJLElBQUssQ0FDekNDLFNBQVUsT0FDVkMsTUFBTyxZQUdYSixLQUFLNkMsV0FBYTdDLEtBQUtDLElBQUlDLEtBQUssSUFBSyxHQUFJLElBQUssQ0FDMUNDLFNBQVUsT0FDVkMsTUFBTyxZQUVYSixLQUFLOEMsZUFDTDlDLEtBQUsrQyxhQUNML0MsS0FBS2dELGFBQ0xoRCxLQUFLaUQsZUFFTGpELEtBQUttQyxRQUFRZSxRQUFRQyxJQUNqQm5ELEtBQUs0QixRQUFRM0IsSUFBSW1ELFNBQVNwRCxLQUFLc0MsS0FBTWEsRUFBT3hCLFVBR2hEM0IsS0FBSzRCLFFBQVEzQixJQUFJb0QsUUFBUXJELEtBQUtzQyxLQUFNdEMsS0FBS3NELFNBQVV0RCxLQUFLdUQsZUFBZ0IsS0FBTXZELE1BQzlFQSxLQUFLNEIsUUFBUTNCLElBQUlvRCxRQUFRckQsS0FBS3NDLEtBQU10QyxLQUFLd0QsVUFBV3hELEtBQUt5RCxjQUFlLEtBQU16RCxNQUM5RUEsS0FBSzBELE9BQVMxRCxLQUFLMkQsTUFBTUMsU0FBU0MsT0FBTyxVQUFhQyxTQUFTQyxTQUFTQyxJQUM1RSxDQUVBLFlBQUFmLEdBQ0ksTUFBTWdCLEVBQWEsSUFBSW5ELEVBQU9kLEtBQU0sVUFBVyxHQUFJLEtBQzdDa0UsRUFBYyxJQUFJcEQsRUFBT2QsS0FBTSxVQUFXLElBQUssS0FDckRBLEtBQUttQyxRQUFRZ0MsSUFBSSxVQUFXRixHQUM1QmpFLEtBQUttQyxRQUFRZ0MsSUFBSSxVQUFXRCxHQWM1QmxFLEtBQUtxQyxjQVplLENBQ2hCLENBQ0krQixTQUFVLFVBQ1ZDLE1BQU8sSUFDUEMsUUFBUyxLQUViLENBQ0lGLFNBQVUsVUFDVkMsTUFBTyxLQUNQQyxRQUFTLFNBSWpCdEUsS0FBS3FDLGNBQWdCckMsS0FBS3FDLGNBQWNrQyxJQUFJQyxJQUNqQyxDQUNISixTQUFVSSxFQUFPSixTQUNqQkssU0FBVXpFLEtBQUsyRCxNQUFNQyxTQUFTQyxPQUFPLFVBQWFDLFNBQVNDLFNBQVNTLEVBQU9ILFFBQzNFSyxXQUFZMUUsS0FBSzJELE1BQU1DLFNBQVNDLE9BQU8sVUFBYUMsU0FBU0MsU0FBU1MsRUFBT0YsWUFHekYsQ0FFQSxjQUFBZixHQUNJLElBQUt2RCxLQUFLeUMsUUFBUyxPQUVuQnpDLEtBQUt5QyxTQUFVLEVBQ2YsTUFBTWtDLEVBQVUzRSxLQUFLbUMsUUFBUTlDLElBQUksV0FDakNzRixFQUFRekQsT0FBUyxFQUNqQmxCLEtBQUs2QyxXQUFXK0IsUUFBUUQsRUFBUXpELE1BQU0yRCxZQUVsQ0YsRUFBUXpELE9BQVMsRUFDakJsQixLQUFLOEUsUUFBUSxXQUViOUUsS0FBSytFLFdBRWIsQ0FFQSxhQUFBdEIsR0FDSSxJQUFLekQsS0FBS3lDLFFBQVMsT0FFbkJ6QyxLQUFLeUMsU0FBVSxFQUNmLE1BQU11QyxFQUFVaEYsS0FBS21DLFFBQVE5QyxJQUFJLFdBQ2pDMkYsRUFBUTlELE9BQVMsRUFDakJsQixLQUFLNEMsVUFBVWdDLFFBQVFJLEVBQVE5RCxNQUFNMkQsWUFFakNHLEVBQVE5RCxPQUFTLEVBQ2pCbEIsS0FBSzhFLFFBQVEsV0FFYjlFLEtBQUsrRSxXQUViLENBRUEsT0FBQUQsQ0FBUUcsR0FDSmpGLEtBQUtzQyxLQUFLNEMsWUFBWSxFQUFHLEdBQ3pCbEYsS0FBS21DLFFBQVFlLFFBQVFDLElBQ2pCQSxFQUFPeEIsT0FBT3VELFlBQVksRUFBRyxLQUVqQ2xGLEtBQUs0QixRQUFRdUQsUUFFYixNQUFNQyxFQUEwQixZQUFiSCxFQUF5QixvQkFBc0IscUJBQ2xFakYsS0FBS0MsSUFBSUMsS0FBSyxJQUFLLElBQUtrRixFQUFXLENBQy9CakYsU0FBVSxPQUNWQyxNQUFPLFlBQ1JDLFVBQVUsSUFFYixNQUFNZ0YsRUFBVXJGLEtBQUtDLElBQUlDLEtBQUssSUFBSyxJQUFLLGlCQUFpQixDQUNyREMsU0FBVSxPQUNWQyxNQUFPLFlBQ1JDLFVBQVUsSUFDWkUsZUFBZSxDQUFFQyxlQUFlLElBQ2hDQyxHQUFHLGNBQWUsSUFBTTRFLEVBQVFDLFNBQVMsWUFDekM3RSxHQUFHLGFBQWMsSUFBTTRFLEVBQVFDLFNBQVMsWUFDeEM3RSxHQUFHLGNBQWUsS0FDZlQsS0FBS1ksTUFBTUMsTUFBTSxjQUV6QixDQUVBLFNBQUFrRSxHQUNJL0UsS0FBS3NDLEtBQUs0QyxZQUFZLEVBQUcsR0FDekJsRixLQUFLc0MsS0FBS2lELFlBQVksSUFBSyxLQUMzQnZGLEtBQUt3RixLQUFLQyxZQUFZLElBQU0sS0FDeEJ6RixLQUFLZ0QsY0FFYixDQUVBLFlBQUFGLEdBQ0k5QyxLQUFLc0QsU0FBV3RELEtBQUs0QixRQUFRM0IsSUFBSTBCLE9BQU8sRUFBRyxJQUFLLE1BQ2hEM0IsS0FBS3NELFNBQVNvQyxlQUFlLEdBQUksS0FDakMxRixLQUFLc0QsU0FBU3ZCLEtBQUs0RCxRQUFRLEdBQUksS0FDL0IzRixLQUFLc0QsU0FBU3pCLGNBQWEsR0FDM0I3QixLQUFLc0QsU0FBU3NDLFlBQVcsR0FFekI1RixLQUFLd0QsVUFBWXhELEtBQUs0QixRQUFRM0IsSUFBSTBCLE9BQU8sSUFBSyxJQUFLLE1BQ25EM0IsS0FBS3dELFVBQVVrQyxlQUFlLEdBQUksS0FDbEMxRixLQUFLd0QsVUFBVXpCLEtBQUs0RCxRQUFRLEdBQUksS0FDaEMzRixLQUFLd0QsVUFBVTNCLGNBQWEsR0FDNUI3QixLQUFLd0QsVUFBVW9DLFlBQVcsRUFDOUIsQ0FFQSxVQUFBN0MsR0FDSSxNQUFNekIsRUFBV3RCLEtBQUtDLElBQUlxQixXQUMxQkEsRUFBU0MsVUFBVSxVQUNuQkQsRUFBU3VFLFdBQVcsRUFBRyxFQUFHLEdBQzFCdkUsRUFBU0csZ0JBQWdCLE9BQVEsR0FBSSxJQUNyQ0gsRUFBU0ksVUFFVDFCLEtBQUtzQyxLQUFPdEMsS0FBSzRCLFFBQVEzQixJQUFJNkYsTUFBTSxJQUFLLElBQUssUUFDN0M5RixLQUFLc0MsS0FBS1IsdUJBQXNCLEdBQ2hDOUIsS0FBS3NDLEtBQUt5RCxVQUFVLEVBQ3hCLENBRUEsVUFBQS9DLEdBQ0ksTUFBTWdELEVBQVEsU0FBWUMsU0FBUyxHQUFJLElBRWpDQyxFQUFZQyxLQUFLQyxTQUFXLEdBQU0sR0FBSyxFQUM3Q3BHLEtBQUt5QyxTQUFVLEVBRWZ6QyxLQUFLc0MsS0FBSzRDLFlBSkksSUFLVmlCLEtBQUtFLElBQUksU0FBWUMsU0FBU04sSUFBa0JFLEVBTHRDLElBTVZDLEtBQUtJLElBQUksU0FBWUQsU0FBU04sSUFFdEMsQ0FFQSxhQUFBUSxDQUFjakUsR0FDVnZDLEtBQUt1QyxTQUFXQSxFQUVadkMsS0FBS3VDLFdBQ0x2QyxLQUFLWSxNQUFNNkYsT0FBTyxhQUFjLENBQUNDLGNBQWUsY0FDaEQxRyxLQUFLWSxNQUFNdUUsUUFFbkIsQ0FFQSxNQUFBd0IsR0FDSTNHLEtBQUt1QyxVQUFXLENBQ3BCLENBRUEsV0FBQXFFLEdBQ0ksTUFBTUMsR0FBa0I3RyxLQUFLdUMsU0FDN0J2QyxLQUFLd0csY0FBY0ssRUFDdkIsQ0FFQSxNQUFBQyxHQUVROUcsS0FBSzBELE9BQU9xRCxRQUNaL0csS0FBSzRHLGNBR1Q1RyxLQUFLcUMsY0FBY2EsUUFBUThELElBQ3ZCLE1BQU03RCxFQUFTbkQsS0FBS21DLFFBQVE5QyxJQUFJMkgsRUFBUTVDLFVBRXBDNEMsRUFBUXZDLFNBQVNzQyxPQUNqQjVELEVBQU94QixPQUFPc0YsY0FBYzlELEVBQU85QixXQUM1QjJGLEVBQVF0QyxXQUFXcUMsT0FDMUI1RCxFQUFPeEIsT0FBT3NGLGNBQWM5RCxFQUFPOUIsV0FFbkM4QixFQUFPeEIsT0FBT3NGLGFBQWEsSUFLdkMsRUNsTkcsTUFBTUMsVUFBbUIsVUFDNUIsV0FBQXJILEdBQ0lDLE1BQU0sYUFDVixDQUVBLE1BQUFDLENBQU9vSCxHQUNIbkgsS0FBS0MsSUFBSTBDLFVBQVUsSUFBSyxJQUFLLEVBQUcsRUFBRyxFQUFHLElBRXRDLE1BQU15RSxFQUFZcEgsS0FBS0MsSUFBSUMsS0FBSyxJQUFLLElBQUssU0FBVSxDQUNoREMsU0FBVSxPQUNWQyxNQUFPLFlBQ1JDLFVBQVUsSUFDWkUsZUFBZSxDQUFDQyxlQUFlLElBQy9CQyxHQUFHLFlBQWEsSUFBTTJHLEVBQVUxRyxTQUFTLENBQUNDLEtBQU0sYUFDaERGLEdBQUcsV0FBWSxJQUFNMkcsRUFBVTFHLFNBQVMsQ0FBQ0MsS0FBTSxhQUMvQ0YsR0FBRyxjQUFlLEtBQ2ZULEtBQUtZLE1BQU15RyxPQUNYckgsS0FBS1ksTUFBTStGLE9BQU9RLEVBQUtULGVBQ3ZCMUcsS0FBS1ksTUFBTXZCLElBQUk4SCxFQUFLVCxlQUFlQyxXQUdqQ3RCLEVBQVVyRixLQUFLQyxJQUFJQyxLQUFLLElBQUssSUFBSyxpQkFBa0IsQ0FDdERDLFNBQVUsT0FDVkMsTUFBTyxZQUNSQyxVQUFVLElBQ1pFLGVBQWUsQ0FBQ0MsZUFBZSxJQUMvQkMsR0FBRyxZQUFhLElBQU00RSxFQUFRM0UsU0FBUyxDQUFDQyxLQUFNLGFBQzlDRixHQUFHLFdBQVksSUFBTTRFLEVBQVEzRSxTQUFTLENBQUNDLEtBQU0sYUFDN0NGLEdBQUcsY0FBZSxLQUNmVCxLQUFLWSxNQUFNeUcsS0FBS0YsRUFBS1QsZUFDckIxRyxLQUFLWSxNQUFNQyxNQUFNLGNBRXpCLEVDNUJKLE1BQU0yRCxFQUFTLENBQ1g4QyxLQUFNLFNBQ05DLE1BQU8sSUFDUEMsT0FBUSxJQUNSQyxPQUFRLGlCQUNSN0YsUUFBUyxDQUNMOEYsUUFBUyxTQUNUQyxPQUFRLENBQ0pDLFFBQVMsQ0FBQzNHLEVBQUcsR0FDYjRHLE9BQU8sSUFJZmpILE1BQU8sQ0FBQ2hCLEVBQVdxQyxFQUFXaUYsR0FDOUJZLGdCQUFpQixhQUdSLElBQUksVUFBWXRELEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljZS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9wcmFjdGljZS93ZWJwYWNrL3J1bnRpbWUvY29tcGF0IGdldCBkZWZhdWx0IGV4cG9ydCIsIndlYnBhY2s6Ly9wcmFjdGljZS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vcHJhY3RpY2Uvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9wcmFjdGljZS9leHRlcm5hbCB2YXIgXCJQaGFzZXJcIiIsIndlYnBhY2s6Ly9wcmFjdGljZS8uL3NyYy9zY2VuZS9NZW51U2NlbmUuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY2UvLi9zcmMvZW50aXRpZXMvUGFkZGxlLmpzIiwid2VicGFjazovL3ByYWN0aWNlLy4vc3JjL3NjZW5lL0dhbWVTY2VuZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljZS8uL3NyYy9zY2VuZS9QYXVzZVNjZW5lLmpzIiwid2VicGFjazovL3ByYWN0aWNlLy4vc3JjL21haW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIi8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSAobW9kdWxlKSA9PiB7XG5cdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuXHRcdCgpID0+IChtb2R1bGVbJ2RlZmF1bHQnXSkgOlxuXHRcdCgpID0+IChtb2R1bGUpO1xuXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCB7IGE6IGdldHRlciB9KTtcblx0cmV0dXJuIGdldHRlcjtcbn07IiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSBQaGFzZXI7IiwiaW1wb3J0IFBoYXNlciBmcm9tIFwicGhhc2VyXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTWVudVNjZW5lIGV4dGVuZHMgUGhhc2VyLlNjZW5lIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCdNZW51U2NlbmUnKVxyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZSgpIHtcclxuICAgICAgICB0aGlzLmFkZC50ZXh0KDQwMCwxMDAsICdQT05HIEdBTUUnLFxyXG4gICAgICAgIHsgICBmb250U2l6ZTogJzY0cHgnLFxyXG4gICAgICAgICAgICBjb2xvcjogJyNmZmZmZmZmZidcclxuICAgICAgICB9KS5zZXRPcmlnaW4oMC41KTtcclxuXHJcbiAgICAgICAgY29uc3QgbG9jYWxCdG4gPSB0aGlzLmFkZC50ZXh0KDQwMCwgMzAwLCAnTG9jYWwgUGxheScsIHtcclxuICAgICAgICAgICAgZm9udFNpemU6ICcyNHB4JywgY29sb3I6ICcjMWRkNjI3ZmYnXHJcbiAgICAgICAgfSkuc2V0T3JpZ2luKDAuNSlcclxuICAgICAgICAuc2V0SW50ZXJhY3RpdmUoe3VzZUhhbmRDdXJzb3I6IHRydWV9KVxyXG4gICAgICAgIC5vbigncG9pbnRvdmVyJywgKCkgPT4gbG9jYWxCdG4uc2V0U3R5bGUoe2ZpbGw6ICcjZTdiMTRkZmYnfSkpXHJcbiAgICAgICAgLm9uKCdwb2ludG91dCcsICgpID0+IGxvY2FsQnRuLnNldFN0eWxlKHtmaWxsOiAnIzFkZDYyN2ZmJ30pKVxyXG4gICAgICAgIC5vbigncG9pbnRlcmRvd24nLCAoKSA9PntcclxuICAgICAgICAgICAgdGhpcy5zY2VuZS5zdGFydCgnR2FtZVNjZW5lJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIFBhZGRsZSB7XG5cbiAgICBjb25zdHJ1Y3RvcihzY2VuZSwgaWQsIHgsIHkpIHtcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICB0aGlzLnNjZW5lID0gc2NlbmU7XG4gICAgICAgIHRoaXMuc2NvcmUgPSAwO1xuXG4gICAgICAgIHRoaXMuYmFzZUhlaWdodCA9IDEwMDtcbiAgICAgICAgdGhpcy5iYXNlV2lkdGggPSAyMDtcbiAgICAgICAgdGhpcy5iYXNlU3BlZWQgPSAzMDA7XG5cbiAgICAgICAgY29uc3QgZ3JhcGhpY3MgPSB0aGlzLnNjZW5lLmFkZC5ncmFwaGljcygpO1xuICAgICAgICBncmFwaGljcy5maWxsU3R5bGUoMHgwMGZmMDApO1xuICAgICAgICBncmFwaGljcy5maWxsUmVjdCgwLCAwLCB0aGlzLmJhc2VXaWR0aCwgdGhpcy5iYXNlSGVpZ2h0KTtcbiAgICAgICAgZ3JhcGhpY3MuZ2VuZXJhdGVUZXh0dXJlKGBwYWRkbGUtJHtpZH1gLCB0aGlzLmJhc2VXaWR0aCwgdGhpcy5iYXNlSGVpZ2h0KTtcbiAgICAgICAgZ3JhcGhpY3MuZGVzdHJveSgpO1xuXG4gICAgICAgIHRoaXMuc3ByaXRlID0gdGhpcy5zY2VuZS5waHlzaWNzLmFkZC5zcHJpdGUoeCwgeSwgYHBhZGRsZS0ke2lkfWApO1xuICAgICAgICB0aGlzLnNwcml0ZS5zZXRJbW1vdmFibGUodHJ1ZSk7XG4gICAgICAgIHRoaXMuc3ByaXRlLnNldENvbGxpZGVXb3JsZEJvdW5kcyh0cnVlKTtcbiAgICAgICAgdGhpcy5zcHJpdGUuYm9keS5hbGxvd0dyYXZpdHkgPSBmYWxzZTtcbiAgICB9XG59IiwiaW1wb3J0IFBoYXNlciBmcm9tIFwicGhhc2VyXCI7XHJcbmltcG9ydCB7IFBhZGRsZSB9IGZyb20gXCIuLi9lbnRpdGllcy9QYWRkbGUuanNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBHYW1lU2NlbmUgZXh0ZW5kcyBQaGFzZXIuU2NlbmV7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcignR2FtZVNjZW5lJylcclxuICAgIH1cclxuXHJcbiAgICBpbml0KCkge1xyXG4gICAgICAgIHRoaXMucGxheWVycyA9IG5ldyBNYXAoKTtcclxuICAgICAgICB0aGlzLmlucHV0c01hcHBpbmcgPSBbXTtcclxuICAgICAgICB0aGlzLmJhbGwgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNQYXVzZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmVzY1dhc0Rvd24gPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnBsYXlpbmcgPSBmYWxzZTtcclxuICAgIH0gXHJcblxyXG4gICAgY3JlYXRlKCkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTc7aSsrKXtcclxuICAgICAgICAgICAgdGhpcy5hZGQucmVjdGFuZ2xlKDQwMCwgaSAqIDUwICsgMjUsIDEwLCAzMCwgMHhmZmZmZmYpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gU2NvcmUgdGV4dHNcclxuICAgICAgICB0aGlzLnNjb3JlTGVmdCA9IHRoaXMuYWRkLnRleHQoMTAwLCA1MCwgJzAnLCB7XHJcbiAgICAgICAgICAgIGZvbnRTaXplOiAnNDhweCcsXHJcbiAgICAgICAgICAgIGNvbG9yOiAnIzAwZmYwMCdcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICB0aGlzLnNjb3JlUmlnaHQgPSB0aGlzLmFkZC50ZXh0KDcwMCwgNTAsICcwJywge1xyXG4gICAgICAgICAgICBmb250U2l6ZTogJzQ4cHgnLFxyXG4gICAgICAgICAgICBjb2xvcjogJyMwMGZmMDAnXHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLmNyZWF0ZUJvdW5kcygpO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlQmFsbCgpO1xyXG4gICAgICAgIHRoaXMubGF1bmNoQmFsbCgpO1xyXG4gICAgICAgIHRoaXMuc2V0VXBQTGF5ZXJzKCk7XHJcblxyXG4gICAgICAgIHRoaXMucGxheWVycy5mb3JFYWNoKHBhZGRsZSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucGh5c2ljcy5hZGQuY29sbGlkZXIodGhpcy5iYWxsLCBwYWRkbGUuc3ByaXRlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5waHlzaWNzLmFkZC5vdmVybGFwKHRoaXMuYmFsbCwgdGhpcy5sZWZ0R29hbCwgdGhpcy5zY29yZVJpZ2h0R29hbCwgbnVsbCwgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5waHlzaWNzLmFkZC5vdmVybGFwKHRoaXMuYmFsbCwgdGhpcy5yaWdodEdvYWwsIHRoaXMuc2NvcmVMZWZ0R29hbCwgbnVsbCwgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5lc2NLZXkgPSB0aGlzLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuSW5wdXQuS2V5Ym9hcmQuS2V5Q29kZXMuRVNDKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVcFBMYXllcnMoKSB7XHJcbiAgICAgICAgY29uc3QgbGVmdFBhZGRsZSA9IG5ldyBQYWRkbGUodGhpcywgJ3BsYXllcjEnLCA1MCwgMzAwKTtcclxuICAgICAgICBjb25zdCByaWdodFBhZGRsZSA9IG5ldyBQYWRkbGUodGhpcywgJ3BsYXllcjInLCA3NTAsIDMwMCk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXJzLnNldCgncGxheWVyMScsIGxlZnRQYWRkbGUpO1xyXG4gICAgICAgIHRoaXMucGxheWVycy5zZXQoJ3BsYXllcjInLCByaWdodFBhZGRsZSk7XHJcblxyXG4gICAgICAgIGNvbnN0IElucHV0Q29uZmlnID0gW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJJZDogJ3BsYXllcjEnLFxyXG4gICAgICAgICAgICAgICAgdXBLZXk6ICdXJyxcclxuICAgICAgICAgICAgICAgIGRvd25LZXk6ICdTJyxcclxuICAgICAgICAgICAgfSwgXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHBsYXllcklkOiAncGxheWVyMicsXHJcbiAgICAgICAgICAgICAgICB1cEtleTogJ1VQJyxcclxuICAgICAgICAgICAgICAgIGRvd25LZXk6ICdET1dOJyxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgdGhpcy5pbnB1dHNNYXBwaW5nID0gSW5wdXRDb25maWc7XHJcbiAgICAgICAgdGhpcy5pbnB1dHNNYXBwaW5nID0gdGhpcy5pbnB1dHNNYXBwaW5nLm1hcChjb25maWcgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgcGxheWVySWQ6IGNvbmZpZy5wbGF5ZXJJZCxcclxuICAgICAgICAgICAgICAgIHVwS2V5T2JqOiB0aGlzLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuSW5wdXQuS2V5Ym9hcmQuS2V5Q29kZXNbY29uZmlnLnVwS2V5XSksXHJcbiAgICAgICAgICAgICAgICBkb3duS2V5T2JqOiB0aGlzLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuSW5wdXQuS2V5Ym9hcmQuS2V5Q29kZXNbY29uZmlnLmRvd25LZXldKSxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHNjb3JlUmlnaHRHb2FsKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5wbGF5aW5nKSByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMucGxheWluZyA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnN0IHBsYXllcjIgPSB0aGlzLnBsYXllcnMuZ2V0KCdwbGF5ZXIyJyk7XHJcbiAgICAgICAgcGxheWVyMi5zY29yZSArPSAxO1xyXG4gICAgICAgIHRoaXMuc2NvcmVSaWdodC5zZXRUZXh0KHBsYXllcjIuc2NvcmUudG9TdHJpbmcoKSk7XHJcbiBcclxuICAgICAgICBpZiAocGxheWVyMi5zY29yZSA+PSAyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZW5kR2FtZShcInBsYXllcjJcIik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5yZXNldEJhbGwoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2NvcmVMZWZ0R29hbCgpIHtcclxuICAgICAgICBpZiAoIXRoaXMucGxheWluZykgcmV0dXJuO1xyXG5cclxuICAgICAgICB0aGlzLnBsYXlpbmcgPSBmYWxzZTtcclxuICAgICAgICBjb25zdCBwbGF5ZXIxID0gdGhpcy5wbGF5ZXJzLmdldCgncGxheWVyMScpO1xyXG4gICAgICAgIHBsYXllcjEuc2NvcmUgKz0gMTtcclxuICAgICAgICB0aGlzLnNjb3JlTGVmdC5zZXRUZXh0KHBsYXllcjEuc2NvcmUudG9TdHJpbmcoKSk7XHJcblxyXG4gICAgICAgIGlmIChwbGF5ZXIxLnNjb3JlID49IDIpIHtcclxuICAgICAgICAgICAgdGhpcy5lbmRHYW1lKFwicGxheWVyMVwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnJlc2V0QmFsbCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBlbmRHYW1lKHdpbm5lcklkKSB7XHJcbiAgICAgICAgdGhpcy5iYWxsLnNldFZlbG9jaXR5KDAsIDApO1xyXG4gICAgICAgIHRoaXMucGxheWVycy5mb3JFYWNoKHBhZGRsZSA9PiB7XHJcbiAgICAgICAgICAgIHBhZGRsZS5zcHJpdGUuc2V0VmVsb2NpdHkoMCwgMCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5waHlzaWNzLnBhdXNlKCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHdpbm5lclRleHQgPSB3aW5uZXJJZCA9PT0gJ3BsYXllcjEnID8gJ0xlZnQgUGxheWVyIFdpbnMhJyA6ICdSaWdodCBQbGF5ZXIgV2lucyEnO1xyXG4gICAgICAgIHRoaXMuYWRkLnRleHQoNDAwLCAyNTAsIHdpbm5lclRleHQse1xyXG4gICAgICAgICAgICBmb250U2l6ZTogJzY0cHgnLFxyXG4gICAgICAgICAgICBjb2xvcjogJyMwMGZmMDAnXHJcbiAgICAgICAgfSkuc2V0T3JpZ2luKDAuNSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG1lbnVCdG4gPSB0aGlzLmFkZC50ZXh0KDQwMCwgMzUwLCAnUmV0dXJuIHRvIE1lbnUnLHtcclxuICAgICAgICAgICAgZm9udFNpemU6ICczMnB4JyxcclxuICAgICAgICAgICAgY29sb3I6ICcjZmZmZmZmJ1xyXG4gICAgICAgIH0pLnNldE9yaWdpbigwLjUpXHJcbiAgICAgICAgLnNldEludGVyYWN0aXZlKHsgdXNlSGFuZEN1cnNvcjogdHJ1ZSB9KVxyXG4gICAgICAgIC5vbigncG9pbnRlcm92ZXInLCAoKSA9PiBtZW51QnRuLnNldENvbG9yKCcjY2NjY2NjJykpXHJcbiAgICAgICAgLm9uKCdwb2ludGVyb3V0JywgKCkgPT4gbWVudUJ0bi5zZXRDb2xvcignI2ZmZmZmZicpKVxyXG4gICAgICAgIC5vbigncG9pbnRlcmRvd24nLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NlbmUuc3RhcnQoJ01lbnVTY2VuZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0QmFsbCgpIHtcclxuICAgICAgICB0aGlzLmJhbGwuc2V0VmVsb2NpdHkoMCwgMCk7XHJcbiAgICAgICAgdGhpcy5iYWxsLnNldFBvc2l0aW9uKDQwMCwgMzAwKTtcclxuICAgICAgICB0aGlzLnRpbWUuZGVsYXllZENhbGwoMTAwMCwgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmxhdW5jaEJhbGwoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVCb3VuZHMoKSB7XHJcbiAgICAgICAgdGhpcy5sZWZ0R29hbCA9IHRoaXMucGh5c2ljcy5hZGQuc3ByaXRlKDAsIDMwMCwgbnVsbCk7XHJcbiAgICAgICAgdGhpcy5sZWZ0R29hbC5zZXREaXNwbGF5U2l6ZSgxMCwgNjAwKTtcclxuICAgICAgICB0aGlzLmxlZnRHb2FsLmJvZHkuc2V0U2l6ZSgxMCwgNjAwKTtcclxuICAgICAgICB0aGlzLmxlZnRHb2FsLnNldEltbW92YWJsZShmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5sZWZ0R29hbC5zZXRWaXNpYmxlKGZhbHNlKTtcclxuXHJcbiAgICAgICAgdGhpcy5yaWdodEdvYWwgPSB0aGlzLnBoeXNpY3MuYWRkLnNwcml0ZSg4MDAsIDMwMCwgbnVsbCk7XHJcbiAgICAgICAgdGhpcy5yaWdodEdvYWwuc2V0RGlzcGxheVNpemUoMTAsIDYwMCk7XHJcbiAgICAgICAgdGhpcy5yaWdodEdvYWwuYm9keS5zZXRTaXplKDEwLCA2MDApO1xyXG4gICAgICAgIHRoaXMucmlnaHRHb2FsLnNldEltbW92YWJsZShmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5yaWdodEdvYWwuc2V0VmlzaWJsZShmYWxzZSk7XHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlQmFsbCgpIHtcclxuICAgICAgICBjb25zdCBncmFwaGljcyA9IHRoaXMuYWRkLmdyYXBoaWNzKCk7XHJcbiAgICAgICAgZ3JhcGhpY3MuZmlsbFN0eWxlKDB4ZmZmZmZmKTtcclxuICAgICAgICBncmFwaGljcy5maWxsQ2lyY2xlKDgsIDgsIDgpO1xyXG4gICAgICAgIGdyYXBoaWNzLmdlbmVyYXRlVGV4dHVyZSgnYmFsbCcsIDE2LCAxNik7XHJcbiAgICAgICAgZ3JhcGhpY3MuZGVzdHJveSgpO1xyXG5cclxuICAgICAgICB0aGlzLmJhbGwgPSB0aGlzLnBoeXNpY3MuYWRkLmltYWdlKDQwMCwgMzAwLCAnYmFsbCcpO1xyXG4gICAgICAgIHRoaXMuYmFsbC5zZXRDb2xsaWRlV29ybGRCb3VuZHModHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5iYWxsLnNldEJvdW5jZSgxKTtcclxuICAgIH1cclxuXHJcbiAgICBsYXVuY2hCYWxsKCkge1xyXG4gICAgICAgIGNvbnN0IGFuZ2xlID0gUGhhc2VyLk1hdGguQmV0d2VlbigtMzAsIDMwKTtcclxuICAgICAgICBjb25zdCBzcGVlZCA9IDQwMDtcclxuICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBNYXRoLnJhbmRvbSgpIDwgMC41ID8gMSA6IC0xOyBcclxuICAgICAgICB0aGlzLnBsYXlpbmcgPSB0cnVlO1xyXG5cclxuICAgICAgICB0aGlzLmJhbGwuc2V0VmVsb2NpdHkoXHJcbiAgICAgICAgICAgIE1hdGguY29zKFBoYXNlci5NYXRoLkRlZ1RvUmFkKGFuZ2xlKSkgKiBzcGVlZCAqIGRpcmVjdGlvbixcclxuICAgICAgICAgICAgTWF0aC5zaW4oUGhhc2VyLk1hdGguRGVnVG9SYWQoYW5nbGUpKSAqIHNwZWVkXHJcbiAgICAgICAgKVxyXG4gICAgfVxyXG5cclxuICAgIHNldFBhdXNlU3RhdGUoaXNQYXVzZWQpIHtcclxuICAgICAgICB0aGlzLmlzUGF1c2VkID0gaXNQYXVzZWQ7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmlzUGF1c2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2NlbmUubGF1bmNoKCdQYXVzZVNjZW5lJywge29yaWdpbmFsU2NlbmU6ICdHYW1lU2NlbmUnfSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2NlbmUucGF1c2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmVzdW1lKCkge1xyXG4gICAgICAgIHRoaXMuaXNQYXVzZWQgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGVQYXVzZSgpIHtcclxuICAgICAgICBjb25zdCBuZXdQYXVzZWRTdGF0ZSA9ICF0aGlzLmlzUGF1c2VkO1xyXG4gICAgICAgIHRoaXMuc2V0UGF1c2VTdGF0ZShuZXdQYXVzZWRTdGF0ZSk7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlKCkgeyAvL3RpbWUsIGRlbHRhXHJcblxyXG4gICAgICAgIGlmICh0aGlzLmVzY0tleS5pc0Rvd24pIHtcclxuICAgICAgICAgICAgdGhpcy50b2dnbGVQYXVzZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5pbnB1dHNNYXBwaW5nLmZvckVhY2gobWFwcGluZyA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhZGRsZSA9IHRoaXMucGxheWVycy5nZXQobWFwcGluZy5wbGF5ZXJJZCk7XHJcblxyXG4gICAgICAgICAgICBpZiAobWFwcGluZy51cEtleU9iai5pc0Rvd24pIHtcclxuICAgICAgICAgICAgICAgIHBhZGRsZS5zcHJpdGUuc2V0VmVsb2NpdHlZKC1wYWRkbGUuYmFzZVNwZWVkKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChtYXBwaW5nLmRvd25LZXlPYmouaXNEb3duKSB7XHJcbiAgICAgICAgICAgICAgICBwYWRkbGUuc3ByaXRlLnNldFZlbG9jaXR5WSgrcGFkZGxlLmJhc2VTcGVlZCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwYWRkbGUuc3ByaXRlLnNldFZlbG9jaXR5WSgwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IFBoYXNlciBmcm9tIFwicGhhc2VyXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUGF1c2VTY2VuZSBleHRlbmRzIFBoYXNlci5TY2VuZSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcignUGF1c2VTY2VuZScpO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZShkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5hZGQucmVjdGFuZ2xlKDQwMCwgMzAwLCAwLCAwLCAwLCAwLjEpO1xyXG5cclxuICAgICAgICBjb25zdCByZXN1bWVCdG4gPSB0aGlzLmFkZC50ZXh0KDQwMCwgMzIwLCAnUmVzdW1lJywge1xyXG4gICAgICAgICAgICBmb250U2l6ZTogJzMycHgnLFxyXG4gICAgICAgICAgICBjb2xvcjogJyMwMGZmMDAnXHJcbiAgICAgICAgfSkuc2V0T3JpZ2luKDAuNSlcclxuICAgICAgICAuc2V0SW50ZXJhY3RpdmUoe3VzZUhhbmRDdXJzb3I6IHRydWV9KVxyXG4gICAgICAgIC5vbigncG9pbnRvdmVyJywgKCkgPT4gcmVzdW1lQnRuLnNldFN0eWxlKHtmaWxsOiAnIzAwZmY4OCd9KSlcclxuICAgICAgICAub24oJ3BvaW50b3V0JywgKCkgPT4gcmVzdW1lQnRuLnNldFN0eWxlKHtmaWxsOiAnIzAwZmYwMCd9KSlcclxuICAgICAgICAub24oJ3BvaW50ZXJkb3duJywgKCkgPT57XHJcbiAgICAgICAgICAgIHRoaXMuc2NlbmUuc3RvcCgpO1xyXG4gICAgICAgICAgICB0aGlzLnNjZW5lLnJlc3VtZShkYXRhLm9yaWdpbmFsU2NlbmUpO1xyXG4gICAgICAgICAgICB0aGlzLnNjZW5lLmdldChkYXRhLm9yaWdpbmFsU2NlbmUpLnJlc3VtZSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBtZW51QnRuID0gdGhpcy5hZGQudGV4dCg0MDAsIDQwMCwgJ1JldHVybiB0byBNZW51Jywge1xyXG4gICAgICAgICAgICBmb250U2l6ZTogJzMycHgnLFxyXG4gICAgICAgICAgICBjb2xvcjogJyNmZmZmZmYnXHJcbiAgICAgICAgfSkuc2V0T3JpZ2luKDAuNSlcclxuICAgICAgICAuc2V0SW50ZXJhY3RpdmUoe3VzZUhhbmRDdXJzb3I6IHRydWV9KVxyXG4gICAgICAgIC5vbigncG9pbnRvdmVyJywgKCkgPT4gbWVudUJ0bi5zZXRTdHlsZSh7ZmlsbDogJyNmZjg4ODgnfSkpXHJcbiAgICAgICAgLm9uKCdwb2ludG91dCcsICgpID0+IG1lbnVCdG4uc2V0U3R5bGUoe2ZpbGw6ICcjZmZmZmZmJ30pKVxyXG4gICAgICAgIC5vbigncG9pbnRlcmRvd24nLCAoKSA9PntcclxuICAgICAgICAgICAgdGhpcy5zY2VuZS5zdG9wKGRhdGEub3JpZ2luYWxTY2VuZSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2NlbmUuc3RhcnQoJ01lbnVTY2VuZScpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIFxyXG5cclxuXHJcbn0iLCJpbXBvcnQgUGhhc2VyIGZyb20gJ3BoYXNlcic7XHJcblxyXG5pbXBvcnQgeyBNZW51U2NlbmUgfSBmcm9tICcuL3NjZW5lL01lbnVTY2VuZS5qcyc7XHJcbmltcG9ydCB7IEdhbWVTY2VuZSB9IGZyb20gJy4vc2NlbmUvR2FtZVNjZW5lLmpzJztcclxuaW1wb3J0IHsgUGF1c2VTY2VuZSB9IGZyb20gJy4vc2NlbmUvUGF1c2VTY2VuZS5qcyc7XHJcblxyXG5jb25zdCBjb25maWcgPSB7XHJcbiAgICB0eXBlOiBQaGFzZXIuQVVUTyxcclxuICAgIHdpZHRoOiA4MDAsXHJcbiAgICBoZWlnaHQ6IDYwMCxcclxuICAgIHBhcmVudDogJ2dhbWUtY29udGFpbmVyJyxcclxuICAgIHBoeXNpY3M6IHtcclxuICAgICAgICBkZWZhdWx0OiAnYXJjYWRlJyxcclxuICAgICAgICBhcmNhZGU6IHtcclxuICAgICAgICAgICAgZ3Jhdml0eToge3k6IDB9LFxyXG4gICAgICAgICAgICBkZWJ1ZzogZmFsc2VcclxuICAgICAgICB9IFxyXG4gICAgfSxcclxuXHJcbiAgICBzY2VuZTogW01lbnVTY2VuZSwgR2FtZVNjZW5lLCBQYXVzZVNjZW5lXSxcclxuICAgIGJhY2tncm91bmRDb2xvcjogJyMzNjAyNDZmZidcclxufVxyXG5cclxuY29uc3QgZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZShjb25maWcpOyJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZXhwb3J0cyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlBoYXNlciIsIk1lbnVTY2VuZSIsImNvbnN0cnVjdG9yIiwic3VwZXIiLCJjcmVhdGUiLCJ0aGlzIiwiYWRkIiwidGV4dCIsImZvbnRTaXplIiwiY29sb3IiLCJzZXRPcmlnaW4iLCJsb2NhbEJ0biIsInNldEludGVyYWN0aXZlIiwidXNlSGFuZEN1cnNvciIsIm9uIiwic2V0U3R5bGUiLCJmaWxsIiwic2NlbmUiLCJzdGFydCIsIlBhZGRsZSIsImlkIiwieCIsInkiLCJzY29yZSIsImJhc2VIZWlnaHQiLCJiYXNlV2lkdGgiLCJiYXNlU3BlZWQiLCJncmFwaGljcyIsImZpbGxTdHlsZSIsImZpbGxSZWN0IiwiZ2VuZXJhdGVUZXh0dXJlIiwiZGVzdHJveSIsInNwcml0ZSIsInBoeXNpY3MiLCJzZXRJbW1vdmFibGUiLCJzZXRDb2xsaWRlV29ybGRCb3VuZHMiLCJib2R5IiwiYWxsb3dHcmF2aXR5IiwiR2FtZVNjZW5lIiwiaW5pdCIsInBsYXllcnMiLCJNYXAiLCJpbnB1dHNNYXBwaW5nIiwiYmFsbCIsImlzUGF1c2VkIiwiZXNjV2FzRG93biIsInBsYXlpbmciLCJpIiwicmVjdGFuZ2xlIiwic2NvcmVMZWZ0Iiwic2NvcmVSaWdodCIsImNyZWF0ZUJvdW5kcyIsImNyZWF0ZUJhbGwiLCJsYXVuY2hCYWxsIiwic2V0VXBQTGF5ZXJzIiwiZm9yRWFjaCIsInBhZGRsZSIsImNvbGxpZGVyIiwib3ZlcmxhcCIsImxlZnRHb2FsIiwic2NvcmVSaWdodEdvYWwiLCJyaWdodEdvYWwiLCJzY29yZUxlZnRHb2FsIiwiZXNjS2V5IiwiaW5wdXQiLCJrZXlib2FyZCIsImFkZEtleSIsIktleWJvYXJkIiwiS2V5Q29kZXMiLCJFU0MiLCJsZWZ0UGFkZGxlIiwicmlnaHRQYWRkbGUiLCJzZXQiLCJwbGF5ZXJJZCIsInVwS2V5IiwiZG93bktleSIsIm1hcCIsImNvbmZpZyIsInVwS2V5T2JqIiwiZG93bktleU9iaiIsInBsYXllcjIiLCJzZXRUZXh0IiwidG9TdHJpbmciLCJlbmRHYW1lIiwicmVzZXRCYWxsIiwicGxheWVyMSIsIndpbm5lcklkIiwic2V0VmVsb2NpdHkiLCJwYXVzZSIsIndpbm5lclRleHQiLCJtZW51QnRuIiwic2V0Q29sb3IiLCJzZXRQb3NpdGlvbiIsInRpbWUiLCJkZWxheWVkQ2FsbCIsInNldERpc3BsYXlTaXplIiwic2V0U2l6ZSIsInNldFZpc2libGUiLCJmaWxsQ2lyY2xlIiwiaW1hZ2UiLCJzZXRCb3VuY2UiLCJhbmdsZSIsIkJldHdlZW4iLCJkaXJlY3Rpb24iLCJNYXRoIiwicmFuZG9tIiwiY29zIiwiRGVnVG9SYWQiLCJzaW4iLCJzZXRQYXVzZVN0YXRlIiwibGF1bmNoIiwib3JpZ2luYWxTY2VuZSIsInJlc3VtZSIsInRvZ2dsZVBhdXNlIiwibmV3UGF1c2VkU3RhdGUiLCJ1cGRhdGUiLCJpc0Rvd24iLCJtYXBwaW5nIiwic2V0VmVsb2NpdHlZIiwiUGF1c2VTY2VuZSIsImRhdGEiLCJyZXN1bWVCdG4iLCJzdG9wIiwidHlwZSIsIndpZHRoIiwiaGVpZ2h0IiwicGFyZW50IiwiZGVmYXVsdCIsImFyY2FkZSIsImdyYXZpdHkiLCJkZWJ1ZyIsImJhY2tncm91bmRDb2xvciJdLCJzb3VyY2VSb290IjoiIn0=